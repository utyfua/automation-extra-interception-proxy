# automation-extra-interception-proxy

Simple way to play with a site requests and responses by the plugin for puppeteer-extra.

Using a proxy is optional.

Tested in `puppeteer/chromium` only!

# Why?

## 1. Traffic sniffing

Time to time required to reach information from the browser request. By default you can reach easily only to headers information. If you want to just read all responses you also can do that but time to time it will throw errors by one of next reasons.

At first page can be already closed and then your code will throw an error.

At second some sites using service workers for requesting some information. Unfortunately you cant handle this situation without manual requesting and then converting to puppeteer.

## 2. Data manipulation

If you want just adjust some requests or responses you should do that manually.

Example. You want get original request/response and do some adjustments. This package will help do that easily. You just getting what you want by single function call.

## 3. Set proxy

Yes, puppeteer already have a proxy support throw additional process arguments. But you should manually maintain proxy credentials each request(?, not sure). Also you cant use socks proxy(?, not sure).

## 4. Asynchronous decisions for requests

Even with cooperative mode you can not make your decisions asynchronously. Here you can chain of handlers with will proceed request decision one by one. Also you can say that this is latest decision and no need to ask another handlers in the chain. Also in one handler you can can adjust request/response for the next one.

# API

<!--
    Documentation is auto-generated by a custom fork of documentation.js
    More info: https://github.com/berstend/documentation-markdown-themes/wiki#documentationjs-with-markdown-theme-support
    Update this documentation by updating the source code.
-->

### Table of Contents

-   [wrapPage(page)](#wrappagepage)

## [wrapPage(page)](https://github.com/utyfua/automation-extra-interception-proxy/blob/4e469c2c8835b24d6a12fc83801c5f643c353cf9/src/index.ts#L17-L19)

-   `page` **Puppeteer.Page** Page for future interceptions

Returns: **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;InterceptionProxyPageConfig>** 

Add interception ability to the page ([sample](https://github.com/utyfua/automation-extra-interception-proxy/blob/master/samples/singlePageInterception.js))

* * *

# Motivation

We live in the world where almost each website have internal api. When you are looking at the network tab in Chrome DevTools its easy to handle where and what. Data already yours but you cant just get what you want. But you have to fight for the information you desired for. So lets fight together!

# TODO:

-   aborting request api
-   request.setResponse api
-   request wrapping api

-   fix non frame request(ex <https://2ip.ru/privacy/>)
-   add tests
-   -   cors
-   -   [cookies](https://github.com/puppeteer/puppeteer/blob/main/test/cookies.spec.ts)
-   documentation
-   add more proxy api
-   add new puppeteer page interfaces via global types
-   data url support
-   websocket support
-   single page interception api
-   migrate to [automation-extra-plugin](https://www.npmjs.com/package/automation-extra-plugin)

# notes?

More specified example. We have Google ReCaptcha to solve. But when you going to automate this thing you will got an error. From first looks it will looks like... TODO?
